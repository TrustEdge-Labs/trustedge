# Requirements Archive: v1.0 Consolidation

**Archived:** 2026-02-11
**Status:** SHIPPED
**Outcome:** 17/17 requirements satisfied (100%)

For current requirements, see `.planning/REQUIREMENTS.md`.

---

# Requirements: TrustEdge Consolidation

**Defined:** 2026-02-09
**Core Value:** A single, reliable trustedge-core library that owns all cryptographic operations with production-quality YubiKey integration — thin CLIs and WASM bindings are just frontends.

## v1 Requirements (All Complete)

### Foundation

- [x] **FOUND-01**: Dependency graph analyzed and cross-crate duplication mapped — Phase 1 (cargo-modules, cargo-machete, cargo-semver-checks, cargo-hack integrated)
- [x] **FOUND-02**: Layered module hierarchy created in trustedge-core (primitives/backends/protocols/applications/transport/io) — Phase 1
- [x] **FOUND-03**: Test inventory baseline documented (348 tests across workspace) — Phase 1

### Error Handling

- [x] **ERR-01**: Unified TrustEdgeError enum with 7 subsystem variants (Crypto, Backend, Transport, Archive, Manifest, Chain, Asymmetric) — Phase 2
- [x] **ERR-02**: All 10+ duplicate error types consolidated into hierarchy — Phase 2
- [x] **ERR-03**: thiserror for library code, anyhow restricted to CLI binaries only — Phase 2

### Code Integration

- [x] **INTG-01**: trst-core manifest types merged via trst-protocols (renamed), WASM-compatible — Phase 3
- [x] **INTG-02**: Duplicate ManifestError resolved (ManifestFormatError in trst-protocols, alias in core) — Phase 3
- [x] **INTG-03**: Receipts system (1,281 LOC, 23 tests) merged into core applications/receipts/ — Phase 4
- [x] **INTG-04**: Attestation system (826 LOC, 10 tests) merged into core applications/attestation/ — Phase 5

### Feature Flags

- [x] **FEAT-01**: Feature flags consolidated into categories: Backend (yubikey) and Platform (audio) — Phase 6
- [x] **FEAT-02**: CI matrix tests critical feature combinations (default, yubikey, audio, all-features, WASM) — Phase 6

### Backward Compatibility

- [x] **COMPAT-01**: Deprecated re-export facades for receipts and attestation crates (module-level #![deprecated], v0.3.0) — Phase 7
- [x] **COMPAT-02**: MIGRATION.md (228 lines) with before/after examples, troubleshooting, timeline — Phase 7

### Validation

- [x] **VAL-01**: 343 tests preserved (98.6% of 348 baseline; -5 from intentional deduplication) — Phase 8
- [x] **VAL-02**: WASM build succeeds (cargo check --target wasm32-unknown-unknown) — Phase 8
- [x] **VAL-03**: Zero API breakage (196 semver checks passed across all crates) — Phase 8

## v2 Requirements (Deferred)

Tracked but not in v1.0 scope. Carried forward to next milestone.

### Pubky Integration

- **PUBKY-01**: Pubky adapter merged into core protocols/pubky/ (feature-gated)
- **PUBKY-02**: Pubky-advanced hybrid encryption merged into core

### Hardware Validation

- **HW-01**: YubiKey hardware tests pass after consolidation (requires physical hardware)

### Developer Experience

- **DX-01**: Prelude module for common imports
- **DX-02**: Updated documentation with module-level security considerations

## Out of Scope

| Feature | Reason |
|---------|--------|
| TPM support | Premature, no hardware to test against |
| Post-quantum cryptography | Research phase only, no production use case |
| New crypto features | This milestone is consolidation only |
| no_std support | Requires separate milestone, half-measures are worse |
| Deleting any code | Everything is preserved, just reorganized |
| Algorithm agility changes | Hard-coded Ed25519/AES-256-GCM is sufficient |

## Traceability (Final)

| Requirement | Phase | Status |
|-------------|-------|--------|
| FOUND-01 | Phase 1 | Complete |
| FOUND-02 | Phase 1 | Complete |
| FOUND-03 | Phase 1 | Complete |
| ERR-01 | Phase 2 | Complete |
| ERR-02 | Phase 2 | Complete |
| ERR-03 | Phase 2 | Complete |
| INTG-01 | Phase 3 | Complete |
| INTG-02 | Phase 3 | Complete |
| INTG-03 | Phase 4 | Complete |
| INTG-04 | Phase 5 | Complete |
| FEAT-01 | Phase 6 | Complete |
| FEAT-02 | Phase 6 | Complete |
| COMPAT-01 | Phase 7 | Complete |
| COMPAT-02 | Phase 7 | Complete |
| VAL-01 | Phase 8 | Complete |
| VAL-02 | Phase 8 | Complete |
| VAL-03 | Phase 8 | Complete |

**Coverage:**
- v1 requirements: 17 total
- Complete: 17 (100%)
- Unmapped: 0

---
*Requirements defined: 2026-02-09*
*Archived: 2026-02-11 after v1.0 milestone completion*
