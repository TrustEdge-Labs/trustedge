---
phase: 13-crate-classification-dependency-audit
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - Cargo.toml
  - crates/core/Cargo.toml
  - crates/trustedge-cli/Cargo.toml
  - crates/trst-protocols/Cargo.toml
  - crates/trst-cli/Cargo.toml
  - crates/trst-wasm/Cargo.toml
  - crates/wasm/Cargo.toml
  - crates/pubky/Cargo.toml
  - crates/pubky-advanced/Cargo.toml
  - crates/receipts/Cargo.toml
  - crates/attestation/Cargo.toml
  - crates/core/README.md
  - crates/trustedge-cli/README.md
  - crates/trst-protocols/README.md
  - crates/trst-cli/README.md
  - crates/trst-wasm/README.md
  - crates/receipts/README.md
  - crates/attestation/README.md
  - crates/wasm/README.md
  - crates/pubky/README.md
  - crates/pubky-advanced/README.md
autonomous: true

must_haves:
  truths:
    - "All 5 core crates have [package.metadata.trustedge] tier = 'stable' in Cargo.toml"
    - "All 5 experimental crates have [package.metadata.trustedge] tier = 'experimental' in Cargo.toml"
    - "Workspace Cargo.toml has comments documenting the 2-tier crate classification"
    - "Facade crates (receipts, attestation) reclassified from deprecated to experimental"
    - "All 5 experimental crate READMEs have experimental/beta banners"
    - "All 5 stable crate READMEs have 'Tier 1 (Stable)' markers"
  artifacts:
    - path: "Cargo.toml"
      provides: "Workspace-level crate tier documentation"
      contains: "Tier 1: Stable"
    - path: "crates/core/Cargo.toml"
      provides: "Core crate stable metadata"
      contains: "tier = \"stable\""
    - path: "crates/receipts/Cargo.toml"
      provides: "Receipts reclassified from deprecated to experimental"
      contains: "tier = \"experimental\""
    - path: "crates/wasm/README.md"
      provides: "Experimental banner on WASM crate"
      contains: "EXPERIMENTAL"
    - path: "crates/core/README.md"
      provides: "Stable marker on core crate README"
      contains: "Tier 1 (Stable)"
    - path: "crates/trustedge-cli/README.md"
      provides: "New README with stable marker for CLI crate"
      contains: "Tier 1 (Stable)"
    - path: "crates/trst-protocols/README.md"
      provides: "New README with stable marker for trst-protocols crate"
      contains: "Tier 1 (Stable)"
    - path: "crates/trst-cli/README.md"
      provides: "New README with stable marker for trst-cli crate"
      contains: "Tier 1 (Stable)"
    - path: "crates/trst-wasm/README.md"
      provides: "Stable marker on trst-wasm README"
      contains: "Tier 1 (Stable)"
  key_links:
    - from: "Cargo.toml"
      to: "crates/*/Cargo.toml"
      via: "workspace members list documents tier classification"
      pattern: "Tier 1.*Stable|Tier 2.*Experimental"
---

<objective>
Classify all 10 workspace crates into stable (Tier 1) and experimental (Tier 2) with Cargo.toml metadata, workspace documentation, and README banners for experimental crates.

Purpose: Establish clear maintainability boundaries so a solo developer knows which crates are production-committed vs community/experimental. This is the foundation for Phase 14's CI prioritization.
Output: All Cargo.toml files updated with tier metadata, workspace Cargo.toml documented, experimental READMEs bannered, stable READMEs marked, facade crates reclassified.
</objective>

<execution_context>
@/home/john/.claude/get-shit-done/workflows/execute-plan.md
@/home/john/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md

Tier classification:
- **Tier 1 (Stable):** core, trustedge-cli, trst-protocols, trst-cli, trst-wasm
- **Tier 2 (Experimental):** wasm, pubky, pubky-advanced, receipts, attestation

Key constraint: v1.2 is "mark, not destroy" — no crate deletion, just classification.

Facade crates (receipts, attestation) currently say "DEPRECATED: Use trustedge-core instead" in description. Reclassify to experimental with no maintenance commitment (per CLSF-04).
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add tier metadata to all Cargo.toml files and document in workspace</name>
  <files>
    Cargo.toml
    crates/core/Cargo.toml
    crates/trustedge-cli/Cargo.toml
    crates/trst-protocols/Cargo.toml
    crates/trst-cli/Cargo.toml
    crates/trst-wasm/Cargo.toml
    crates/wasm/Cargo.toml
    crates/pubky/Cargo.toml
    crates/pubky-advanced/Cargo.toml
    crates/receipts/Cargo.toml
    crates/attestation/Cargo.toml
  </files>
  <action>
    **1. Add `[package.metadata.trustedge]` section to all 10 crate Cargo.toml files.**

    For the 5 **stable** crates (core, trustedge-cli, trst-protocols, trst-cli, trst-wasm), add after existing `[package.metadata.*]` sections (or after `[package]` if none exist):

    ```toml
    [package.metadata.trustedge]
    tier = "stable"
    maintained = true
    ```

    For the 5 **experimental** crates (wasm, pubky, pubky-advanced, receipts, attestation), add:

    ```toml
    [package.metadata.trustedge]
    tier = "experimental"
    maintained = false
    ```

    **2. Reclassify facade crates (CLSF-04).**

    For `crates/receipts/Cargo.toml`:
    - Change `description` from "DEPRECATED: Use trustedge-core instead. Digital receipt system..." to "Experimental re-export facade for trustedge-core receipts. No maintenance commitment."
    - Change `keywords` from `["deprecated", ...]` to `["experimental", "cryptography", "receipts", "facade", "trustedge"]`

    For `crates/attestation/Cargo.toml`:
    - Change `description` from "DEPRECATED: Use trustedge-core instead. Hardware-backed..." to "Experimental re-export facade for trustedge-core attestation. No maintenance commitment."
    - Change `keywords` from `["deprecated", ...]` to `["experimental", "cryptography", "attestation", "facade", "trustedge"]`

    **3. Document crate tiers in workspace Cargo.toml.**

    Add a comment block in the workspace `Cargo.toml` after the `[workspace]` section (before `resolver = "2"`), documenting the 2-tier system:

    ```toml
    # Crate Classification
    #
    # Tier 1 (Stable) — production-committed, tested in CI, maintained:
    #   - trustedge-core          (core cryptographic library)
    #   - trustedge-cli           (main CLI binary)
    #   - trustedge-trst-protocols (archive format definitions)
    #   - trustedge-trst-cli      (archive CLI binary)
    #   - trustedge-trst-wasm     (browser archive verification)
    #
    # Tier 2 (Experimental) — community/experimental, build-only CI, no maintenance commitment:
    #   - trustedge-wasm          (general WASM bindings)
    #   - trustedge-pubky         (Pubky network adapter)
    #   - trustedge-pubky-advanced (Pubky hybrid encryption)
    #   - trustedge-receipts      (re-export facade, use trustedge-core directly)
    #   - trustedge-attestation   (re-export facade, use trustedge-core directly)
    ```

    **4. Verify build still works after changes.**

    Run `cargo check --workspace` to confirm no TOML parsing errors.
  </action>
  <verify>
    Run `cargo check --workspace` — must succeed.
    Run `cargo metadata --format-version 1 | jq -r '.packages[] | select(.name | startswith("trustedge")) | "\(.name): \(.metadata.trustedge.tier // "MISSING")"' | sort` — all 10 crates should show their tier (5 "stable", 5 "experimental", 0 "MISSING").
  </verify>
  <done>All 10 crates have `[package.metadata.trustedge]` tier metadata (5 stable, 5 experimental). Workspace Cargo.toml has tier documentation comment. Facade crates reclassified from deprecated to experimental. `cargo check --workspace` passes.</done>
</task>

<task type="auto">
  <name>Task 2: Add experimental/beta banners to experimental crate READMEs</name>
  <files>
    crates/wasm/README.md
    crates/pubky/README.md
    crates/pubky-advanced/README.md
    crates/receipts/README.md
    crates/attestation/README.md
  </files>
  <action>
    Add a prominent experimental/beta banner to each of the 5 experimental crate READMEs. Insert the banner immediately after the copyright header and crate title (before any existing content).

    **Banner template** (adapt crate name and description for each):

    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). It builds and passes basic checks but has no maintenance commitment. For production use, depend on `trustedge-core` directly.
    ```

    Specific banners:

    **crates/wasm/README.md** — After title:
    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). General WASM bindings for TrustEdge. No maintenance commitment. For browser archive verification, use `trustedge-trst-wasm` (Tier 1) instead.
    ```

    **crates/pubky/README.md** — After title:
    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). Community-contributed Pubky network adapter. No maintenance commitment.
    ```

    **crates/pubky-advanced/README.md** — After title:
    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). Community-contributed Pubky hybrid encryption. No maintenance commitment.
    ```

    **crates/receipts/README.md** — After title, replacing any existing deprecation notice:
    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). Re-export facade for `trustedge-core` receipts. No maintenance commitment. Depend on `trustedge-core` directly for production use.
    ```

    **crates/attestation/README.md** — After title, replacing any existing deprecation notice:
    ```markdown
    > **EXPERIMENTAL** -- This crate is Tier 2 (experimental). Re-export facade for `trustedge-core` attestation. No maintenance commitment. Depend on `trustedge-core` directly for production use.
    ```

    Read each README first to understand its structure, then insert the banner in the appropriate location. If a README has an existing deprecation notice, replace it with the experimental banner.
  </action>
  <verify>
    For each of the 5 experimental crate READMEs, confirm the banner exists:
    `grep -l "EXPERIMENTAL" crates/wasm/README.md crates/pubky/README.md crates/pubky-advanced/README.md crates/receipts/README.md crates/attestation/README.md`
    — should return all 5 files.
  </verify>
  <done>All 5 experimental crate READMEs have prominent "EXPERIMENTAL" banners with tier classification and maintenance status. Facade crate banners direct users to trustedge-core.</done>
</task>

<task type="auto">
  <name>Task 3: Add stable markers to stable crate READMEs (create missing READMEs)</name>
  <files>
    crates/core/README.md
    crates/trustedge-cli/README.md
    crates/trst-protocols/README.md
    crates/trst-cli/README.md
    crates/trst-wasm/README.md
  </files>
  <action>
    Add "Tier 1 (Stable)" markers to all 5 stable crate READMEs. Two already exist (core, trst-wasm); three must be created (trustedge-cli, trst-protocols, trst-cli).

    **For existing READMEs (core, trst-wasm):**

    Read the existing README.md, then insert a stable badge immediately after the crate title (first `# ...` heading):

    ```markdown
    > **STABLE** -- This crate is Tier 1 (Stable). Production-committed, tested in CI, and actively maintained.
    ```

    Do not alter any other content in these READMEs.

    **For missing READMEs (trustedge-cli, trst-protocols, trst-cli):**

    Create minimal README.md files with the MPL-2.0 copyright header, crate title, stable badge, and a one-line description.

    **crates/trustedge-cli/README.md:**
    ```markdown
    <!--
    Copyright (c) 2025 TRUSTEDGE LABS LLC
    MPL-2.0: https://mozilla.org/MPL/2.0/
    -->

    # trustedge-cli

    > **STABLE** -- This crate is Tier 1 (Stable). Production-committed, tested in CI, and actively maintained.

    Main CLI binary for TrustEdge envelope encryption. Binary name: `trustedge`.
    ```

    **crates/trst-protocols/README.md:**
    ```markdown
    <!--
    Copyright (c) 2025 TRUSTEDGE LABS LLC
    MPL-2.0: https://mozilla.org/MPL/2.0/
    -->

    # trustedge-trst-protocols

    > **STABLE** -- This crate is Tier 1 (Stable). Production-committed, tested in CI, and actively maintained.

    Canonical cam.video manifest types for the .trst archive format. WASM-compatible with minimal dependencies.
    ```

    **crates/trst-cli/README.md:**
    ```markdown
    <!--
    Copyright (c) 2025 TRUSTEDGE LABS LLC
    MPL-2.0: https://mozilla.org/MPL/2.0/
    -->

    # trustedge-trst-cli

    > **STABLE** -- This crate is Tier 1 (Stable). Production-committed, tested in CI, and actively maintained.

    CLI tool for .trst archive wrap/verify operations. Binary name: `trst`.
    ```
  </action>
  <verify>
    `grep -l "Tier 1 (Stable)" crates/core/README.md crates/trustedge-cli/README.md crates/trst-protocols/README.md crates/trst-cli/README.md crates/trst-wasm/README.md` — should return all 5 files.
  </verify>
  <done>All 5 stable crate READMEs exist and contain "Tier 1 (Stable)" markers. Existing READMEs (core, trst-wasm) have stable badge inserted. New READMEs (trustedge-cli, trst-protocols, trst-cli) created with copyright header, title, stable badge, and description.</done>
</task>

</tasks>

<verification>
1. `cargo check --workspace` passes (no TOML errors)
2. All 10 crate Cargo.toml files have `[package.metadata.trustedge]` with correct tier
3. Workspace Cargo.toml has tier documentation comment block
4. Facade crates (receipts, attestation) have experimental descriptions, not deprecated
5. All 5 experimental crate READMEs have "EXPERIMENTAL" banner
6. All 5 stable crate Cargo.toml files have `tier = "stable"`
7. All 5 stable crate READMEs have "Tier 1 (Stable)" marker
</verification>

<success_criteria>
Requirements covered: CLSF-01, CLSF-02, CLSF-03, CLSF-04
- 5 core crates marked stable in Cargo.toml metadata and README markers (CLSF-01)
- 5 experimental crates marked experimental in Cargo.toml metadata and README banners (CLSF-02)
- Workspace Cargo.toml documents the 2-tier classification (CLSF-03)
- Facade crates reclassified from deprecated to experimental (CLSF-04)
- All 5 stable crate READMEs have "Tier 1 (Stable)" marker
- All 5 experimental crate READMEs have "EXPERIMENTAL" banner
- Workspace builds cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/13-crate-classification-dependency-audit/13-01-SUMMARY.md`
</output>
