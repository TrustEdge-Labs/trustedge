---
phase: 07-backward-compatibility
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - crates/receipts/src/lib.rs
  - crates/receipts/Cargo.toml
  - crates/receipts/README.md
  - crates/attestation/src/lib.rs
  - crates/attestation/Cargo.toml
  - crates/attestation/README.md
autonomous: true

must_haves:
  truths:
    - "Facade crates show deprecation warnings when imported"
    - "Version bump signals deprecation (0.2.0 → 0.3.0)"
    - "README clearly explains migration path"
  artifacts:
    - path: "crates/receipts/src/lib.rs"
      provides: "Module-level #![deprecated] attribute"
      contains: "#![deprecated"
    - path: "crates/attestation/src/lib.rs"
      provides: "Module-level #![deprecated] attribute"
      contains: "#![deprecated"
    - path: "crates/receipts/README.md"
      provides: "Deprecation notice with migration instructions"
      min_lines: 30
    - path: "crates/attestation/README.md"
      provides: "Deprecation notice with migration instructions"
      min_lines: 30
  key_links:
    - from: "crates/receipts/Cargo.toml"
      to: "version bump"
      via: "version field"
      pattern: "version = \"0\\.3\\.0\""
    - from: "crates/attestation/Cargo.toml"
      to: "version bump"
      via: "version field"
      pattern: "version = \"0\\.3\\.0\""
---

<objective>
Formalize deprecation of facade crates with Rust #[deprecated] attributes and version bumps.

Purpose: Make migration warnings visible to consumers through compiler and documentation.
Output: Deprecated facade crates with clear migration guidance.
</objective>

<execution_context>
@/home/john/.claude/get-shit-done/workflows/execute-plan.md
@/home/john/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-backward-compatibility/07-RESEARCH.md
@.planning/phases/04-receipts-integration/04-01-SUMMARY.md
@.planning/phases/05-attestation-integration/05-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Add formal deprecation to receipts facade crate</name>
  <files>
crates/receipts/src/lib.rs
crates/receipts/Cargo.toml
crates/receipts/README.md
  </files>
  <action>
**Step 1: Update lib.rs with module-level deprecation**

Add `#![deprecated]` attribute at the top of the file (after copyright, before module doc):

```rust
#![deprecated(
    since = "0.3.0",
    note = "This crate has been merged into trustedge-core. \
            Import from `trustedge_core` instead. \
            This facade will be removed in 0.4.0 (August 2026). \
            See https://github.com/TrustEdge-Labs/trustedge/blob/main/MIGRATION.md"
)]
```

Update module doc comment to match deprecation notice pattern from research (keep informal notice, enhance it).

**Step 2: Bump version in Cargo.toml**

Change `version = "0.2.0"` to `version = "0.3.0"`.

Add "deprecated" keyword: Update `keywords` to include "deprecated" as first item.

Update description to start with "DEPRECATED: Use trustedge-core instead."

**Step 3: Create README.md with deprecation notice**

Create `crates/receipts/README.md` with structure from research:
- ⚠️ DEPRECATION NOTICE header
- Timeline (0.3.0 Feb 2026 deprecated, 0.4.0 Aug 2026 removal)
- Before/after code examples for imports
- Link to MIGRATION.md
- Brief description of what receipts are (for docs.rs)

Use exact pattern from research code examples (Pattern 2: README Deprecation Notice).
  </action>
  <verify>
```bash
# Check deprecation attribute present
grep -q "#\!\[deprecated\]" crates/receipts/src/lib.rs

# Check version bump
grep -q 'version = "0.3.0"' crates/receipts/Cargo.toml

# Check README exists and has deprecation header
test -f crates/receipts/README.md && grep -q "DEPRECATION NOTICE" crates/receipts/README.md

# Verify crate compiles with warnings
cargo check -p trustedge-receipts 2>&1 | grep -i "deprecated" || true
```
  </verify>
  <done>
- lib.rs has module-level `#![deprecated]` attribute with since/note fields
- Cargo.toml version bumped to 0.3.0 with "deprecated" keyword
- README.md exists with clear migration guidance and timeline
- Crate compiles successfully
  </done>
</task>

<task type="auto">
  <name>Add formal deprecation to attestation facade crate</name>
  <files>
crates/attestation/src/lib.rs
crates/attestation/Cargo.toml
crates/attestation/README.md
  </files>
  <action>
**Step 1: Update lib.rs with module-level deprecation**

Add `#![deprecated]` attribute at the top of the file (after copyright, before module doc):

```rust
#![deprecated(
    since = "0.3.0",
    note = "This crate has been merged into trustedge-core. \
            Import from `trustedge_core` instead. \
            This facade will be removed in 0.4.0 (August 2026). \
            See https://github.com/TrustEdge-Labs/trustedge/blob/main/MIGRATION.md"
)]
```

Update module doc comment to match deprecation notice pattern from research.

**Step 2: Bump version in Cargo.toml**

Change `version = "0.2.0"` to `version = "0.3.0"`.

Add "deprecated" keyword: Update `keywords` to include "deprecated" as first item.

Update description to start with "DEPRECATED: Use trustedge-core instead."

**Step 3: Create README.md with deprecation notice**

Create `crates/attestation/README.md` with structure from research:
- ⚠️ DEPRECATION NOTICE header
- Timeline (0.3.0 Feb 2026 deprecated, 0.4.0 Aug 2026 removal)
- Before/after code examples for imports (attestation-specific types)
- Link to MIGRATION.md
- Brief description of what attestation is (for docs.rs)

Use exact pattern from research code examples (Pattern 2: README Deprecation Notice).
  </action>
  <verify>
```bash
# Check deprecation attribute present
grep -q "#\!\[deprecated\]" crates/attestation/src/lib.rs

# Check version bump
grep -q 'version = "0.3.0"' crates/attestation/Cargo.toml

# Check README exists and has deprecation header
test -f crates/attestation/README.md && grep -q "DEPRECATION NOTICE" crates/attestation/README.md

# Verify crate compiles with warnings
cargo check -p trustedge-attestation 2>&1 | grep -i "deprecated" || true
```
  </verify>
  <done>
- lib.rs has module-level `#![deprecated]` attribute with since/note fields
- Cargo.toml version bumped to 0.3.0 with "deprecated" keyword
- README.md exists with clear migration guidance and timeline
- Crate compiles successfully
  </done>
</task>

<task type="auto">
  <name>Verify workspace compiles with deprecation warnings</name>
  <files></files>
  <action>
Run full workspace validation to ensure facades still work and deprecation doesn't break builds.

**Step 1: Test facade crates independently**
```bash
cargo test -p trustedge-receipts
cargo test -p trustedge-attestation
```

Both should show 0 tests (facades only), but compile successfully.

**Step 2: Full workspace validation**
```bash
cargo check --workspace
cargo clippy --workspace -- -D warnings
cargo test --workspace
```

All should pass. Facade crates may show deprecation warnings in their own builds, but this is expected and not an error.

**Step 3: Verify thin shells compile**

Thin shells should NOT show deprecation warnings (they import from core, not facades):
```bash
cargo check -p trustedge-cli
cargo check -p trst-cli
cargo check -p trustedge-wasm
cargo check -p trustedge-trst-wasm
```

All should compile clean with no deprecation warnings.
  </action>
  <verify>
```bash
# All workspace crates compile
cargo check --workspace

# No clippy warnings
cargo clippy --workspace -- -D warnings

# All tests pass
cargo test --workspace --quiet

# Thin shells compile (should be clean, no facade usage)
cargo check -p trustedge-cli -q && \
cargo check -p trst-cli -q && \
cargo check -p trustedge-wasm -q && \
cargo check -p trustedge-trst-wasm -q
```
  </verify>
  <done>
- Facade crates compile successfully (with their own deprecation warnings)
- Full workspace builds without errors
- Clippy passes on workspace
- All tests pass (325+ total)
- Thin shells compile clean (no deprecation warnings)
  </done>
</task>

</tasks>

<verification>
1. Both facade crates have module-level `#![deprecated]` attributes
2. Both facade Cargo.toml files show version 0.3.0
3. Both facade README.md files exist with deprecation notices
4. Full workspace compiles successfully
5. Thin shells (CLI, WASM) build without deprecation warnings
6. All tests pass
</verification>

<success_criteria>
- Deprecated re-export facades formalized with `#[deprecated]` attributes (COMPAT-01)
- Version bump (0.2.0 → 0.3.0) signals deprecation
- README documentation provides migration guidance
- All thin shells build successfully
- Deprecation warnings visible but not breaking
</success_criteria>

<output>
After completion, create `.planning/phases/07-backward-compatibility/07-01-SUMMARY.md`
</output>
