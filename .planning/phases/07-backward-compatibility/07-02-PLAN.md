---
phase: 07-backward-compatibility
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - MIGRATION.md
  - CHANGELOG.md
autonomous: true

must_haves:
  truths:
    - "Migration guide documents exact import path changes"
    - "Changelog records deprecation with timeline"
    - "Downstream consumers have clear upgrade instructions"
  artifacts:
    - path: "MIGRATION.md"
      provides: "Step-by-step upgrade guide"
      min_lines: 100
      contains: "trustedge-receipts"
    - path: "CHANGELOG.md"
      provides: "0.3.0 deprecation entry"
      contains: "0.3.0"
  key_links:
    - from: "MIGRATION.md"
      to: "facade READMEs"
      via: "linked from deprecation notices"
      pattern: "MIGRATION\\.md"
    - from: "CHANGELOG.md"
      to: "version timeline"
      via: "deprecation schedule"
      pattern: "0\\.4\\.0.*August 2026"
---

<objective>
Create comprehensive migration documentation for deprecated facade crates.

Purpose: Provide clear upgrade path for downstream consumers with before/after examples and troubleshooting.
Output: MIGRATION.md guide and CHANGELOG.md entry documenting the 0.3.0 deprecation.
</objective>

<execution_context>
@/home/john/.claude/get-shit-done/workflows/execute-plan.md
@/home/john/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-backward-compatibility/07-RESEARCH.md
@CHANGELOG.md
</context>

<tasks>

<task type="auto">
  <name>Create MIGRATION.md guide</name>
  <files>MIGRATION.md</files>
  <action>
Create `MIGRATION.md` at workspace root following the research Pattern 3: Migration Guide Structure.

**Required sections:**

1. **Overview**
   - Explain consolidation: receipts and attestation moved to core
   - Timeline: 0.3.0 (Feb 2026) deprecation ‚Üí 0.4.0 (Aug 2026) removal
   - Why: Single source of truth, reduced compilation units, better maintainability

2. **Timeline Table**
   - 0.2.0 (Jan 2026): Facades active, no warnings
   - 0.3.0 (Feb 2026): Facades deprecated, warnings issued
   - 0.4.0 (Aug 2026): Facades removed, breaking change

3. **Migration Steps**
   - Step 1: Update Cargo.toml dependencies (remove receipts/attestation, use core)
   - Step 2: Update import statements (before/after for each crate)
   - Step 3: Verify compilation (commands to run)

4. **Receipts Migration**
   - Before: `use trustedge_receipts::{Receipt, create_receipt, ...};`
   - After: `use trustedge_core::{Receipt, create_receipt, ...};`
   - Note: All APIs identical, only import paths change

5. **Attestation Migration**
   - Before: `use trustedge_attestation::{Attestation, create_signed_attestation, ...};`
   - After: `use trustedge_core::{Attestation, create_signed_attestation, ...};`
   - Note: All types available at core root (flattened re-exports)

6. **API Compatibility**
   - Emphasize: NO breaking changes to function signatures
   - Emphasize: NO behavior changes
   - Only import paths changed

7. **Troubleshooting**
   - "Cannot find type in this scope" ‚Üí check Cargo.toml has trustedge-core
   - "Multiple versions of trustedge-core" ‚Üí run `cargo tree`, update deps
   - Shell crates fail ‚Üí should not happen, report as bug

8. **Need Help?**
   - Link to GitHub issues

Use exact structure from research code examples (Pattern 3: Migration Guide Structure). Adapt examples to match actual types exported by each facade.
  </action>
  <verify>
```bash
# Verify file exists and has required sections
test -f MIGRATION.md

# Check for key sections
grep -q "Timeline" MIGRATION.md
grep -q "trustedge-receipts" MIGRATION.md
grep -q "trustedge-attestation" MIGRATION.md
grep -q "Troubleshooting" MIGRATION.md

# Check for before/after examples
grep -q "Before:" MIGRATION.md
grep -q "After:" MIGRATION.md

# Verify reasonable length (comprehensive guide)
test $(wc -l < MIGRATION.md) -gt 100
```
  </verify>
  <done>
- MIGRATION.md exists at workspace root
- Contains timeline table with 0.3.0 and 0.4.0 milestones
- Documents import path changes for receipts and attestation
- Includes before/after code examples
- Has troubleshooting section
- Links to GitHub issues for support
  </done>
</task>

<task type="auto">
  <name>Update CHANGELOG.md with 0.3.0 deprecation entry</name>
  <files>CHANGELOG.md</files>
  <action>
Update `CHANGELOG.md` by moving the current [Unreleased] content to a new [0.3.0] section with deprecation details.

**Step 1: Read current CHANGELOG.md**

Identify the [Unreleased] section (starts at line 15).

**Step 2: Create new [0.3.0] section**

Insert new section AFTER [Unreleased], BEFORE the existing [0.3.0] - 2025-01-12 entry (which will be shifted down).

Wait - there's already a [0.3.0] from 2025-01-12. This consolidation will need a NEW version. Check: the current unreleased content shows architecture improvements that are PART of this consolidation project.

Strategy: The existing [0.3.0] is from January 2025. We're now in February 2026 (per phase context). This consolidation work will become a FUTURE 0.3.0 or 0.4.0 release.

Actually, re-reading: The facade crates are being bumped to 0.3.0 NOW (February 2026 per research timeline). But the main workspace may be on a different version.

Correct approach based on research:
- Facade crates (receipts, attestation) are versioned independently
- They're being bumped to 0.3.0 for deprecation
- CHANGELOG should document this as part of workspace consolidation

**Step 3: Add entry to [Unreleased] section**

Add new subsection under [Unreleased]:

```markdown
### ‚ö†Ô∏è Deprecation Notices

**Facade crates deprecated:** `trustedge-receipts` and `trustedge-attestation`
are now deprecated facades. All functionality has been consolidated into
`trustedge-core` during Phases 4-5 of the workspace consolidation.

**Affected crates:**
- `trustedge-receipts` 0.3.0: Now a deprecated facade re-exporting from core
- `trustedge-attestation` 0.3.0: Now a deprecated facade re-exporting from core

**Timeline:**
- 0.3.0 (February 2026): Deprecation warnings issued
- 0.4.0 (August 2026): Facades will be removed from workspace

**Migration:** See [MIGRATION.md](MIGRATION.md) for upgrade instructions.
All functionality remains available through `trustedge-core` with identical APIs.
```

Place this BEFORE the existing "üèóÔ∏è Architecture Improvements" section in [Unreleased].

**Step 4: Add to Architecture Improvements**

Under "#### Workspace Reorganization", add new bullets:
- **Receipts Consolidation**: Moved 1,281 LOC receipts implementation from standalone crate into trustedge-core applications layer (Phase 4)
- **Attestation Consolidation**: Moved 826 LOC attestation implementation from standalone crate into trustedge-core applications layer (Phase 5)
- **Facade Deprecation**: Created deprecated re-export facades for backward compatibility with 6-month migration window (Phase 7)
  </action>
  <verify>
```bash
# Verify deprecation notice added
grep -q "Deprecation Notices" CHANGELOG.md

# Check for facade crate mentions
grep -q "trustedge-receipts" CHANGELOG.md
grep -q "trustedge-attestation" CHANGELOG.md

# Check for timeline
grep -q "0.4.0.*August 2026" CHANGELOG.md

# Check for MIGRATION.md link
grep -q "MIGRATION.md" CHANGELOG.md

# Verify file is valid markdown (no syntax errors)
test -f CHANGELOG.md
```
  </verify>
  <done>
- CHANGELOG.md has deprecation notice in [Unreleased] section
- Timeline clearly states 0.3.0 (Feb 2026) deprecation and 0.4.0 (Aug 2026) removal
- Links to MIGRATION.md guide
- Documents which crates are affected (receipts, attestation)
- Maintains existing changelog structure
  </done>
</task>

<task type="auto">
  <name>Validate documentation consistency</name>
  <files></files>
  <action>
Cross-check all deprecation documentation for consistency in version numbers, dates, and URLs.

**Step 1: Verify version consistency**

All deprecation notices should reference:
- `since = "0.3.0"` in Rust code
- `version = "0.3.0"` in Cargo.toml files
- "0.3.0 (February 2026)" in documentation

All removal references should state:
- "0.4.0 (August 2026)" consistently

**Step 2: Verify URL consistency**

All deprecation notes should link to:
- `https://github.com/TrustEdge-Labs/trustedge/blob/main/MIGRATION.md`

Check this URL in:
- crates/receipts/src/lib.rs (deprecation note)
- crates/attestation/src/lib.rs (deprecation note)
- crates/receipts/README.md
- crates/attestation/README.md

**Step 3: Verify import path examples**

Check that before/after examples are accurate:
- Receipts exports: Receipt, create_receipt, assign_receipt, extract_receipt, verify_receipt_chain
- Attestation exports: Attestation, AttestationConfig, AttestationResult, OutputFormat, KeySource, VerificationConfig, VerificationResult, VerificationDetails, VerificationInfo, create_signed_attestation, verify_attestation

Cross-reference against actual exports in facade lib.rs files.

**Step 4: Spell check and formatting**

Check for:
- Consistent emoji usage: ‚ö†Ô∏è for warnings
- Consistent capitalization: "DEPRECATED", "DEPRECATION NOTICE"
- No typos in crate names (trustedge-core, trustedge-receipts, trustedge-attestation)
  </action>
  <verify>
```bash
# Check version consistency across files
grep -h "0.3.0" crates/receipts/src/lib.rs crates/attestation/src/lib.rs crates/receipts/Cargo.toml crates/attestation/Cargo.toml MIGRATION.md CHANGELOG.md | sort | uniq

# Check removal version consistency
grep -h "0.4.0" crates/receipts/src/lib.rs crates/attestation/src/lib.rs crates/receipts/README.md crates/attestation/README.md MIGRATION.md CHANGELOG.md | sort | uniq

# Check URL consistency
grep -h "github.com.*MIGRATION.md" crates/receipts/src/lib.rs crates/attestation/src/lib.rs crates/receipts/README.md crates/attestation/README.md | sort | uniq

# Verify no typos in crate names
! grep -r "trustedge_receipts" crates/receipts/README.md crates/receipts/Cargo.toml MIGRATION.md
! grep -r "trustedge_attestation" crates/attestation/README.md crates/attestation/Cargo.toml MIGRATION.md
```
  </verify>
  <done>
- All version numbers consistent (0.3.0 for deprecation, 0.4.0 for removal)
- All dates consistent (Feb 2026, Aug 2026)
- All URLs point to same MIGRATION.md location
- Import examples match actual facade exports
- No typos or inconsistencies in documentation
  </done>
</task>

</tasks>

<verification>
1. MIGRATION.md exists with comprehensive upgrade guide
2. CHANGELOG.md documents 0.3.0 deprecation with timeline
3. All version numbers and dates consistent across documentation
4. URLs to MIGRATION.md consistent across all files
5. Before/after examples accurate and helpful
</verification>

<success_criteria>
- Migration guide documents import path changes (COMPAT-02)
- Timeline clearly communicates 6-month migration window
- Troubleshooting section helps downstream consumers
- Documentation consistent across all files
- All APIs confirmed as non-breaking (import paths only)
</success_criteria>

<output>
After completion, create `.planning/phases/07-backward-compatibility/07-02-SUMMARY.md`
</output>
